<head>
   <script src="https://d3js.org/d3.v3.min.js"></script>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js" integrity="sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.full.js"></script>
   <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACUlehJQDDBT85PlM_JzIm_rc8Z0iO4dU&callback=initMap"></script>
   <script src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.7.1/bootstrap-slider.min.js'></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
   <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js'></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.7.1/css/bootstrap-slider.min.css">
   <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet"/>
   <style>
         .navbar-brand{
            margin-right: 50px;
         }
   </style>
</head>
<body id="main">
   <nav class="navbar navbar-default">
      <div class='container-fluid'>
         <div class='navbar-header'>
            <a href="http://www.northropgrumman.com/Pages/default.aspx">
               <img class="navbar-brand navbar-logo" src='/img/ng.png'></img>
            </a>
            <a href="http://www.colorado.edu/cs/senior-project">
               <img class="navbar-brand navbar-logo" src='/img/cu.png'></img>
            </a>
         </div>
         <div class="collapse navbar-collapse">
            <ul class='nav navbar-nav'>
               <li><a class="navbar-brand" href='/'>Air Traffic Analysis</a></li>
               <li><a class="navbar-brand" href='about'>About</a></li>
               <li class='active' href='routing'><a class="navbar-brand" href="about">Routing<span class="sr-only">(current)</span></a></li>
            </ul>
         </div>
      </div>
   </nav>

   <div class='container-fluid'>
      <div class='col-xs-6'>
            <div class='col-xs-6'>
               <h3> Routing Parameters: </h3>
               <label for='grid-size'>Lat/Long Grid size</label>
               <br>
               <input id="grid-size" data-slider-id='gird-sizeSlider' type="text" data-slider-min="0" data-slider-max="250" data-slider-step="1" data-slider-value="14"/>
               <br>
               <label for='altitude'>Altitude Grid</label>
               <br>
               <input id="altitude" data-slider-id='altitudeSlider' type="text" data-slider-min="0" data-slider-max="60000" data-slider-step="1" data-slider-value="14"/>
               <br>
               <label for='heuristic' value='3dDistance'>Heuristic Name
               <br>
               <input id='heuristic' type='text'>
            </div>
         <div class='col-xs-6'>
            <h3> Routes: </h3>
            <label for='Origin'>Origin</label>
            <br>
            <input id='Origin' type='text'>
            <br>
            <label for='Dest'>Destination</label>
            <br>
            <input id='Dest' type='text'>
            <br>
            <label for='json-input'>Enter JSON Object(Leave blank if using dropdowns)</label>
            <br>
            <input id='json-input' type='text'>
            <br>
         </div>
      </div>
   <div class='col-xs-6'>
      <div class='jumbotron'>
         <div class='row'>
            <div class='col-xs-4'>
               <label for='compute-name'>Name (create a name for this route)
               <br>
               <input type='text' id='compute-name'>
               <br>
               <button class='btn btn-success' id='compute'>Compute</button>
            </div>
            <div class='col-xs-8'>
               <label for='routes'>Computed Routes
               <br>
               <input id='routes' style='width:100%;' multiple='multiple'>
               <br>
               <button class='btn btn-success' id='plot'>Plot</button>
               <button class='btn btn-danger' id='delete'>Delete</button>
            </div>
         </div>
      </div>
   </div>
   </div>
   <script>
     $(document).ready(function(){
        $('#grid-size').slider({
            formatter: function(value) {
               return 'Current value: ' + value;
            }
        });

        $('#altitude').slider({
            formatter: function(value) {
               return 'Current value: ' + value;
            }
         });

        $.ajax({
            type: "GET",
            url: "/dropdown-fill/Dest",
            success: function(data){
               $('#destination').select2({
                  data:data['response'],
                  placeholder: "Select an option"
               });
            },
            error: function(error){
               console.log(error);
            }
         });

        $.ajax({
            type: "GET",
            url: "/computed-routes",
            success: function(data){
               var menu_data = $.map(data['response'], function(value, index){
                  console.log(value);
                  return value['jobName'];
               });
               console.log(menu_data);
               $('#routes').select2({
                  data:menu_data,
                  placeholder: "Select an already computed route."
               });
            },
            error: function(error){
               console.log(error);
            }
         });


        $.ajax({
            type: "GET",
            url: "/dropdown-fill/Carrier",
            success: function(data){
               $('#carrier').select2({
                  data:data['response'],
                  placeholder: "Select an option"
               });
            },
            error: function(error){
               console.log(error);
            }
         });


        $.ajax({
            type: "GET",
            url: "/dropdown-fill/Origin",
            success: function(data){
               $('#origin').select2({
                  data:data['response'],
                  placeholder: "Select an option"
               });
            },
            error: function(error){
               console.log(error);
            }
         });


        $('#options').select2({
            data: ["Suggested routes based on filter options", "Routes selected for computation"],
            dropdownAutoWidth : true
        });


        $("#compute").on('click', function(){
              if($('#json-input').val()){
                 var post_object = JSON.parse($('#json-input').val().replace(/\'/g,'"'));
              }
              else{
                 var post_object = {
                     'jobName': $('#compute-name').val(),
                     'Origin': $('#Origin').val(),
                     'Dest': $('#Dest').val(),
                     'gridResPlanar': $('#grid-size').val(),
                     'gridResVert': $('#altitude').val(),
                     'heuristic': $('#heuristic').val()
                 };
              }
              $.ajax({
                  url: "/routing-compute",
                  type: "POST",
                  data: JSON.stringify(post_object),
                  success:function(data){
                     console.log(data);
                  },
                  error: function(error){
                     console.log(error);
                 }
              });
        });

        $("#plot").on('click', function(){
              $.ajax({
                  url: "/display-route/" + $('#routes').val(),
                  type: "GET",
                  success:function(data){
                     console.log(data);
                  },
                  error: function(error){
                     console.log(error);
                 }
              });
        });

        $("#delete").on('click', function(){
              $.ajax({
                  url: "/delete-route/" + $('#routes').val(),
                  type: "GET",
                  success:function(data){
                     console.log(data);
                  },
                  error: function(error){
                     console.log(error);
                 }
              });
        });

      });

   </script>
</body>
